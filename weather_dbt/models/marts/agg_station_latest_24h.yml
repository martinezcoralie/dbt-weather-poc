version: 2

models:
  - name: agg_station_latest_24h
    description: >
      Vue “dernières 24h” par station : dernière observation disponible enrichie avec
      les cumuls 24h et les labels BI (intensité précipitations, Beaufort), plus coordonnées.
      Sert de source directe au dashboard pour les classements et la cartographie.
    columns:
      - name: station_id
        description: Identifiant station (clé vers dim_stations).
        tests:
          - not_null
          - unique
      - name: station_name
        description: Nom de la station.
      - name: latitude
        description: Latitude de la station.
      - name: longitude
        description: Longitude de la station.
      - name: validity_time_utc
        description: Horodate la plus récente disponible pour la station (UTC).
        tests:
          - not_null
      - name: temp_24h_c
        description: Moyenne glissante 24h de la température (°C).
      - name: precip_24h_mm
        description: Cumul 24h des précipitations (mm).
      - name: snow_24h_m
        description: Cumul 24h de neige (m).
      - name: snow_24h_intensity_level
        description: Niveau ordinal d’intensité de neige 24h (dim_snow_intensity).
      - name: snow_24h_intensity_label
        description: Libellé d’intensité de neige 24h.
      - name: precip_24h_intensity_level
        description: Niveau ordinal d’intensité des précipitations 24h (dim_precip_intensity).
      - name: precip_24h_intensity_label
        description: Libellé d’intensité des précipitations 24h.
      - name: wind_beaufort
        description: Niveau Beaufort du vent le plus récent.
      - name: wind_beaufort_label
        description: Libellé Beaufort du vent le plus récent.
      - name: temp_24h_intensity_level
        description: Niveau ordinal d’intensité thermique 24h (dim_temp_intensity).
      - name: temp_24h_intensity_label
        description: Libellé descriptif d’intensité thermique 24h.
      - name: temperature_c
        description: Température la plus récente (°C).
      - name: humidity_pct
        description: Humidité relative la plus récente (%)
      - name: precip_mm_h
        description: Précipitation horaire la plus récente (mm/h).
      - name: wind_speed_kmh
        description: Vitesse du vent la plus récente (km/h).
      - name: wind_sector
        description: Secteur du vent la plus récent.
      - name: visibility_cat
        description: Catégorie de visibilité la plus récente.
      - name: is_temp_comfort
        description: Flag BI — station en confort thermique (temp_24h_intensity_level >= 4).
      - name: is_temp_cool
        description: Flag BI — station fraîche (temp_24h_intensity_level = 3).
      - name: is_temp_cold
        description: Flag BI — station en froid marqué (temp_24h_intensity_level in (1,2)).
      - name: is_rain_heavy
        description: Flag BI — pluie soutenue (precip_24h_intensity_level in (4,5)).
      - name: is_rain_moderate
        description: Flag BI — pluie modérée (precip_24h_intensity_level = 3).
      - name: is_rain_drops
        description: Flag BI — quelques gouttes (precip_24h_intensity_level = 1 et precip_24h_mm > 0).
      - name: is_rain_dry
        description: Flag BI — au sec (precip_24h_mm = 0).
      - name: is_snow_light
        description: Flag BI — neige faible (snow_24h_intensity_level in (2,3)).
      - name: is_snow_heavy
        description: Flag BI — neige forte (snow_24h_intensity_level in (4,5)).
      - name: is_wind_breeze
        description: Flag BI — brise (wind_beaufort in (2,3)).
      - name: is_wind_strong
        description: Flag BI — vent fort (wind_beaufort = 4).
      - name: is_wind_very_strong
        description: Flag BI — vent très fort (wind_beaufort = 5).
      - name: is_wind_calm
        description: Flag BI — pas de vent (wind_beaufort = 1).
