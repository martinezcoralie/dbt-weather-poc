services:
  weather-app:
    build: .                       # construit l’image depuis le Dockerfile à la racine
    volumes:
      - ./data:/app/data           # persiste les données/DuckDB sur le disque hôte (pas dans l’image)
    develop:
      watch:
        - action: sync             # synchro code hôte -> conteneur (hot-reload Streamlit, pas de rebuild)
          path: .
          target: /app
        - action: rebuild          # rebuild si les deps changent
          path: requirements.txt
        - action: rebuild          # rebuild si l’image change
          path: Dockerfile
    env_file:
      - .env                       # injecte les variables d’environnement depuis le fichier .env
    ports:
      - "8501:8501"                # expose le port 8501 du conteneur sur 8501 de l’hôte (Streamlit)
